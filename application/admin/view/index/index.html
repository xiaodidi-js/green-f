{js href="__STATIC__/js/chartjs/Chart.min.js"}
<style>
  .product-img{
    width:50px;
    height:50px;
    background-color:#EFEFEF;
    background-size:cover;
    background-repeat:no-repeat;
    background-position:center;
  }

  .users-list>li div.img{
    width:90%;
    max-width:90%;
    padding-top:90%;
    border-radius:50%;
    background-color:#EFEFEF;
    background-size:cover;
    background-repeat:no-repeat;
    background-position:center;
    margin:auto;
  }

  .exli{
    width:100%;
    max-width:100%;
    white-space:nowrap;
    text-overflow:ellipsis;
    overflow:hidden;
  }
</style>
<!-- Main content -->
<section class="content">
  <!-- Small boxes (Stat box) -->
  <div class="row">
    <div class="col-lg-3 col-xs-6">
      <!-- small box -->
      <div class="small-box bg-aqua">
        <div class="inner">
          <h3>{$count.orders}</h3>
          <p>当天新增订单</p>
        </div>
        <div class="icon">
          <i class="ion ion-bag"></i>
        </div>
      </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-xs-6">
      <!-- small box -->
      <div class="small-box bg-green">
        <div class="inner">
          <h3>{$count.rate}<sup style="font-size: 20px">%</sup></h3>
          <p>订单单日增长率</p>
        </div>
        <div class="icon">
          <i class="ion ion-stats-bars"></i>
        </div>
      </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-xs-6">
      <!-- small box -->
      <div class="small-box bg-yellow">
        <div class="inner">
          <h3>{$count.members}</h3>
          <p>当天新注册用户</p>
        </div>
        <div class="icon">
          <i class="ion ion-person-add"></i>
        </div>
      </div>
    </div>
    <!-- ./col -->
    <div class="col-lg-3 col-xs-6">
      <!-- small box -->
      <div class="small-box bg-red">
        <div class="inner">
          <h3>{$count.pnums}</h3>
          <p>当天产品销售总量</p>
        </div>
        <div class="icon">
          <i class="ion ion-pie-graph"></i>
        </div>
      </div>
    </div>
    <!-- ./col -->
  </div>
  <!-- /.row -->

  <div class="row">
    <div class="col-md-7">
      <!-- PRODUCT LIST -->
        <div class="box box-primary">
          <div class="box-header with-border">
            <h3 class="box-title">最近新增产品</h3>

            <div class="box-tools pull-right">
              <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
              </button>
              <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <ul class="products-list product-list-in-box">
            {foreach name="list.products" item="pvo"}
              <li class="item">
                <div class="product-img" style="background-image:url('{$pvo.shotcut}');"></div>
                <div class="product-info">
                  <a href="{:url('admin/shoper/editproduct',array('id'=>$pvo['id']))}" class="product-title">{$pvo.name}
                    <span class="label label-success pull-right">${$pvo.price}</span></a>
                      <span class="product-description">
                        {$pvo.description}
                      </span>
                </div>
              </li>
            {/foreach}
            </ul>
          </div>
          <!-- /.box-body -->
          <div class="box-footer text-center">
            <a href="{:url('admin/shoper/product')}" class="uppercase">查看所有产品</a>
          </div>
          <!-- /.box-footer -->
        </div>
        <!-- /.box -->
    </div>

    <div class="col-md-5">
      <!-- USERS LIST -->
        <div class="box box-danger">
          <div class="box-header with-border">
            <h3 class="box-title">最近新注册用户</h3>

            <div class="box-tools pull-right">
              <span class="label label-danger">{:count($list['members'])}</span>
              <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
              </button>
              <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i>
              </button>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body no-padding">
            <ul class="users-list clearfix">
            {foreach name="list.members" item="mvo"}
              <li>
                <div class="img" style="background-image:url('{$mvo.shotcut}');"></div>
                <a class="users-list-name" href="#">{$mvo.uname}</a>
                <span class="users-list-date">{$mvo.createtime|date="Y-m-d H:i:s",###}</span>
              </li>
            {/foreach}
            </ul>
            <!-- /.users-list -->
          </div>
          <!-- /.box-body -->
          <div class="box-footer text-center">
            <a href="{:url('admin/shoper/member')}" class="uppercase">查看所有注册用户</a>
          </div>
          <!-- /.box-footer -->
        </div>
      <!--/.box -->
    </div>

    <div class="col-md-7">
      <!-- TABLE: LATEST ORDERS -->
        <div class="box box-info">
          <div class="box-header with-border">
            <h3 class="box-title">最近新增订单</h3>

            <div class="box-tools pull-right">
              <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
              </button>
              <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
            </div>
          </div>
          <!-- /.box-header -->
          <div class="box-body">
            <div class="table-responsive">
              <table class="table no-margin">
                <thead>
                <tr>
                  <th>订单号</th>
                  <th>用户账号</th>
                  <th>支付类型</th>
                  <th>订单状态</th>
                  <th>支付金额</th>
                  <th>创建时间</th>
                </tr>
                </thead>
                <tbody>
                {foreach name="list.orders" item="ovo"}
                  <tr>
                    <td><a href="{:url('admin/shoper/orderdetail',array('id'=>$ovo['id']))}">{$ovo.orderid}</a></td>
                    <td>
                      {$ovo.uname}
                    </td>
                    <td>
                      {switch name="ovo.paytype"}
                        {case value="1" break="1"}
                          微信支付
                        {/case}
                        {case value="2" break="1"}
                          支付宝支付
                        {/case}
                      {/switch}
                    </td>
                    <td>
                      {switch name="ovo.status"}
                        {case value="0" break="1"}
                          <span class="label label-primary">交易进行中</span>
                        {/case}
                        {case value="1" break="1"}
                          <span class="label label-success">交易结束</span>
                        {/case}
                        {case value="-1" break="1"}
                          <span class="label label-warning">用户取消</span>
                        {/case}
                        {case value="-2" break="1"}
                          <span class="label label-danger">申请售后</span>
                        {/case}
                        {case value="-3" break="1"}
                          <span class="label label-gray">交易关闭</span>
                        {/case}
                      {/switch}
                    </td>
                    <td>
                      {$ovo.money}
                    </td>
                    <td>
                      {$ovo.createtime|date="Y-m-d H:i:s",###}
                    </td>
                  </tr>
                {/foreach}
                </tbody>
              </table>
            </div>
            <!-- /.table-responsive -->
          </div>
          <!-- /.box-body -->
          <div class="box-footer clearfix">
            <a href="{:url('admin/shoper/orders')}" class="btn btn-sm btn-info btn-flat">查看所有订单</a>
          </div>
          <!-- /.box-footer -->
        </div>
        <!-- /.box -->
    </div>
  
    <div class="col-md-5">
      <div class="box box-default">
        <div class="box-header with-border">
          <h3 class="box-title">产品销量Top5</h3>

          <div class="box-tools pull-right">
            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
            </button>
            <button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-times"></i></button>
          </div>
        </div>
        <!-- /.box-header -->
        <div class="box-body">
          <div class="row">
            <div class="col-md-8">
              <div class="chart-responsive">
                <canvas id="pieChart" height="150"></canvas>
              </div>
              <!-- ./chart-responsive -->
            </div>
            <!-- /.col -->
            <div class="col-md-4">
              <ul class="chart-legend clearfix">
                {foreach name="list.exdata" item="exvo"}
                  <li class="exli"><i class="fa fa-circle-o" style="color:{$exvo.color};"></i> {$exvo.name}</li>
                {/foreach}
              </ul>
            </div>
            <!-- /.col -->
          </div>
          <!-- /.row -->
        </div>
        <!-- /.box-body -->
        <div class="box-footer no-padding">
          <ul class="nav nav-pills nav-stacked">
            {foreach name="list.exdata" item="exvo2"}
              <li><a>{$exvo2.name} <span class="pull-right" style="color:{$exvo2.color};"> {$exvo2.sale}</span></a></li>
            {/foreach}
          </ul>
        </div>
        <!-- /.footer -->
      </div>
      <!-- /.box -->
    </div>
  </div>
  
  <div style="float:none;clear:both;"></div>

</section>
<!-- /.content -->

<script>
    //-------------
    //- PIE CHART -
    //-------------
    // Get context with jQuery - using jQuery's .get() method.
    var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
    var pieChart = new Chart(pieChartCanvas);
    var PieData = JSON.parse('{$list.sale}');
    var pieOptions = {
      //Boolean - Whether we should show a stroke on each segment
      segmentShowStroke: true,
      //String - The colour of each segment stroke
      segmentStrokeColor: "#fff",
      //Number - The width of each segment stroke
      segmentStrokeWidth: 1,
      //Number - The percentage of the chart that we cut out of the middle
      percentageInnerCutout: 50, // This is 0 for Pie charts
      //Number - Amount of animation steps
      animationSteps: 100,
      //String - Animation easing effect
      animationEasing: "easeOutBounce",
      //Boolean - Whether we animate the rotation of the Doughnut
      animateRotate: true,
      //Boolean - Whether we animate scaling the Doughnut from the centre
      animateScale: false,
      //Boolean - whether to make the chart responsive to window resizing
      responsive: true,
      // Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
      maintainAspectRatio: false,
      //String - A legend template
      legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>",
      //String - A tooltip template
      tooltipTemplate: "<%=value %> <%=label%> users"
    };
    //Create pie or douhnut chart
    // You can switch between pie and douhnut using the method below.
    pieChart.Doughnut(PieData, pieOptions);
    //-----------------
    //- END PIE CHART -
    //-----------------
</script>